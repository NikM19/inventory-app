{% extends "base.html" %}

{% block title %}–¢–æ–≤–∞—Ä—ã{% endblock %}

{% block content %}

<div class="container mt-4">

    <h1 class="mb-4">üì¶ –£—á—ë—Ç —Ç–æ–≤–∞—Ä–æ–≤</h1>

    <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
    <div class="mb-3">
        <a href="{{ url_for('create') }}" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</a>
        <a href="{{ url_for('add_category') }}" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</a>
    </div>

    <!-- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä -->
    <form method="get" action="{{ url_for('index') }}" class="row g-3 mb-4">
        <div class="col-md-4">
            <input type="text" name="q" value="{{ search_query }}" class="form-control" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é...">
        </div>
        <div class="col-md-3">
            <select name="category_id" class="form-select">
                <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                {% for category in categories %}
                <option value="{{ category.id }}" {% if category_id == category.id %}selected{% endif %}>{{ category.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-2">
            <select name="currency" class="form-select">
                <option value="‚Ç¨" {% if currency == '‚Ç¨' %}selected{% endif %}>–ï–≤—Ä–æ (‚Ç¨)</option>
                <option value="$" {% if currency == '$' %}selected{% endif %}>–î–æ–ª–ª–∞—Ä—ã ($)</option>
            </select>
        </div>
        <div class="col-md-3">
            <button type="submit" class="btn btn-secondary w-100">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        </div>
    </form>

    <!-- –¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤ -->
    <table class="table table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                <th>–¶–µ–Ω–∞</th>
                <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for product in products %}
            <tr>
                <td>{{ product.id }}</td>
                <td>{{ product.name }}</td>
                <td>{{ product.category.name if product.category else '' }}</td>
                <td>{{ product.price }} {{ currency }}</td>
                <td>{{ product.quantity }}</td>
                <td>
                    <a href="{{ url_for('view', product_id=product.id) }}" class="btn btn-sm btn-info">–ü—Ä–æ—Å–º–æ—Ç—Ä</a>
                    <a href="{{ url_for('edit', product_id=product.id) }}" class="btn btn-sm btn-warning">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                    <form action="{{ url_for('delete', product_id=product.id) }}" method="post" style="display:inline;">
                        <button type="submit" class="btn btn-sm btn-danger">–£–¥–∞–ª–∏—Ç—å</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Dashboard -->
    <div class="mt-5">
        <h4>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</h4>
        <ul class="list-group">
            <li class="list-group-item">–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: <strong>{{ total_products }}</strong></li>
            <li class="list-group-item">–í—Å–µ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: <strong>{{ total_categories }}</strong></li>
            <li class="list-group-item">–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: <strong>{{ total_value }} {{ currency }}</strong></li>
        </ul>
    </div>

    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ -->
    <div class="mt-5">
        <h4>üÜï –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã:</h4>
        <ul class="list-group">
            {% for product in recent_products %}
            <li class="list-group-item">
                {{ product.name }} ({{ product.price }} {{ currency }}) ‚Äî {{ product.created_at.strftime('%Y-%m-%d %H:%M') }}
            </li>
            {% endfor %}
        </ul>
    </div>

</div>

{% endblock %}
